/**
*
*   RegexAnalyzer
*   @version: 0.5.0
*
*   A simple Regular Expression Analyzer for PHP, Python, Node/XPCOM/JS, ActionScript
*   https://github.com/foo123/RegexAnalyzer
*
**/
!function(e,t,n){"use strict";"undefined"!=typeof Components&&"object"==typeof Components.classes&&"object"==typeof Components.classesByID&&Components.utils&&"function"==typeof Components.utils["import"]?(e.$deps=e.$deps||{})&&(e.EXPORTED_SYMBOLS=[t])&&(e[t]=e.$deps[t]=n.call(e)):"object"==typeof module&&module.exports?(module.$deps=module.$deps||{})&&(module.exports=module.$deps[t]=n.call(e)):"undefined"!=typeof System&&"function"==typeof System.register&&"function"==typeof System["import"]?System.register(t,[],function(r){r(t,n.call(e))}):"function"==typeof define&&define.amd&&"function"==typeof require&&"function"==typeof require.specified&&require.specified(t)?define(t,["module"],function(t){return n.moduleUri=t.uri,n.call(e)}):t in e||(e[t]=n.call(e)||1)&&"function"==typeof define&&define.amd&&define(function(){return e[t]})}(this,"RegexAnalyzer",function(e){"use strict";var t="0.5.0",n="prototype",r=Object,a=(Array,r.keys,r[n].toString,String.fromCharCode),l="charAt",u="charCodeAt",s=(JSON.stringify,1/0),i="hasOwnProperty",o="\\",f={".":"MatchAnyChar","|":"MatchEither","?":"MatchZeroOrOne","*":"MatchZeroOrMore","+":"MatchOneOrMore","^":"MatchStart",$:"MatchEnd","{":"StartRepeats","}":"EndRepeats","(":"StartGroup",")":"EndGroup","[":"StartCharGroup","]":"EndCharGroup"},p={"\\":"EscapeChar","/":"/",0:"NULChar",f:"FormFeed",n:"LineFeed",r:"CarriageReturn",t:"HorizontalTab",v:"VerticalTab",b:"MatchWordBoundary",B:"MatchNonWordBoundary",s:"MatchSpaceChar",S:"MatchNonSpaceChar",w:"MatchWordChar",W:"MatchNonWordChar",d:"MatchDigitChar",D:"MatchNonDigitChar"},c=1,h=2,g=3,v=4,d=5,m=6,M=7,y=8,C=9,O=10,b=11,S=function(e){var t=this;t.re=e,t.len=e.length,t.pos=0,t.groupIndex=0,t.inGroup=0},x=function fe(e,t,n){var r=this;if(!(r instanceof fe))return new fe(e,t,n);switch(r.type=e,r.val=t,r.flags=n||{},e){case c:r.typeName="Sequence";break;case h:r.typeName="Alternation";break;case g:r.typeName="Group";break;case y:r.typeName="CharacterGroup";break;case C:r.typeName="Characters";break;case O:r.typeName="CharacterRange";break;case b:r.typeName="String";break;case v:r.typeName="Quantifier";break;case d:r.typeName="UnicodeChar";break;case m:r.typeName="HexChar";break;case M:r.typeName="Special"}};x.toObjectStatic=function pe(e){return e instanceof x?{type:e.typeName,value:pe(e.val),flags:e.flags}:e instanceof Array?e.map(pe):e},x[n]={constructor:x,type:null,typeName:null,val:null,flags:null,dispose:function(){var e=this;return e.val=null,e.flags=null,e.type=null,e.typeName=null,e},toObject:function(){return x.toObjectStatic(this)}};var N=function(e,t){return Math.round((t-e)*Math.random()+e)},I=function(e){return e[u](0)},A=function(e){return[e[u](0),e[u](e.length-1)]},E=function(e,t){e&&"function"==typeof e.push&&(t=e[1],e=e[0]);var n,r,l=e[u](0),s=t[u](0);if(s==l)return[a(l)];for(r=[],n=l;s>=n;++n)r.push(a(n));return r},G=function(e,t){if(t){var n,r;if("function"==typeof t.push)for(n=0,r=t.length;r>n;n++)e[t[n]]=1;else for(n in t)t[i](n)&&(e[n]=1)}return e},k=" 	\x0B",w="~!@#$%^&*()-+=[]{}\\|;:,./<>?",L="0123456789",Z=A(L),j=[Z,[I("a"),I("f")],[I("A"),I("F")]],z="_"+E("a","z").join("")+E("A","Z").join(""),R=k+w+L+z,$=R.split(""),B=function(e,t,n,r,a){n=n||0,r=r||1,a=a||s;for(var u,i=n,o=0,f=t.length;f>i&&a>=o&&-1<e.indexOf(u=t[l](i));)i++,o++;return o>=r?o:!1},D=function(e,t,n,r,a){n=n||0,r=r||1,a=a||s;for(var l,i=n,o=0,f=t.length;f>i&&a>=o&&(l=t[u](i))>=e[0]&&l<=e[1];)i++,o++;return o>=r?o:!1},W=function(e,t,n,r,a){n=n||0,r=r||1,a=a||s;for(var l,i,o,f=n,p=0,c=t.length,h=e.length,g=!0;c>f&&a>=p&&g;)for(l=t[u](f),g=!1,i=0;h>i;i++)if(o=e[i],l>=o[0]&&l<=o[1]){f++,p++,g=!0;break}return p>=r?p:!1},U=function(){return w[l](N(0,w.length-1))},q=function(e){return!1!==e?k[l](N(0,k.length-1)):(U()+F()+T())[l](N(0,2))},F=function(e){return!1!==e?L[l](N(0,L.length-1)):(U()+q()+T())[l](N(0,2))},T=function(e){return!1!==e?z[l](N(0,z.length-1)):(U()+q()+F())[l](N(0,2))},_=function(e){return!1!==e?(z+L)[l](N(0,z.length+L.length-1)):(U()+q())[l](N(0,1))},H=function(){return R[l](N(0,R.length-1))},P=function(e,t){if(!1!==t)return e.length?e[N(0,e.length-1)]:"";var n=$.filter(function(t){return 0>e.indexOf(t)});return n.length?n[N(0,n.length-1)]:""},V=function(e){return N(0,1)?e.toLowerCase():e.toUpperCase()},J=function(e,t){return t?(e[l]&&(e=e.split("")),e=e.map(V)):V(e)},Q=function ce(e,t,n){if(!t||!n)return e;var r,a,l,u=t.type;if(h===u||c===u||y===u||g===u||v===u){if(l=n.map(e,t,n),null!=n.ret)e=n.reduce(e,t,n),n.ret=null;else if(null!=l)for(l instanceof Array||(l=[l]),r=0,a=l?l.length:0;a>r;r++)if(n.node=t,e=ce(e,l[r],n),n.stop)return n.stop=null,e}else C!==u&&O!==u&&d!==u&&m!==u&&M!==u&&b!==u||(e=n.reduce(e,t,n));return n.node=null,e},X=function(e,t,n){var r=t.type;if(h===r||y===r)return t.val.length?t.val[N(0,t.val.length-1)]:null;if(v===r){var a,l,u,s;if(e.length>=n.maxLength?a=t.flags.MatchZeroOrMore||t.flags.MatchZeroOrOne?0:t.flags.MatchOneOrMore?1:parseInt(t.flags.MatchMinimum,10):t.flags.MatchZeroOrMore?a=N(0,1+2*n.maxLength):t.flags.MatchZeroOrOne?a=N(0,1):t.flags.MatchOneOrMore?a=N(1,1+2*n.maxLength):(l=parseInt(t.flags.MatchMinimum,10),u="unlimited"===t.flags.MatchMaximum?l+1+2*n.maxLength:parseInt(t.flags.MatchMaximum,10),a=N(l,u)),a){s=new Array(a);for(var i=0;a>i;i++)s[i]=t.val;return s}return null}return t.val},Y=function(e,t,n){var r=t.type;if(h===r){var a,l,u=t.val.length,s=u?Q(0,t.val[0],n):0;for(a=1;u>a;a++)l=Q(0,t.val[a],n),s>l&&(s=l);return u&&(n.ret=s),null}if(y===r)return t.val.length?t.val[0]:null;if(v===r){if(t.flags.MatchMinimum){if("0"===t.flags.MatchMinimum)return null;var a,i=parseInt(t.flags.MatchMinimum,10),o=new Array(i);for(a=0;i>a;a++)o[a]=t.val;return o}return t.flags.MatchOneOrMore?t.val:null}return t.val},K=function(e,t,n){var r=t.type;if(h===r){var a,l,u=t.val.length,s=u?Q(0,t.val[0],n):0;if(-1!==s)for(a=1;u>a;a++){if(l=Q(0,t.val[a],n),-1===l){s=-1;break}l>s&&(s=l)}return u&&(n.ret=s),null}return y===r?t.val.length?t.val[0]:null:v===r?(s=Q(0,t.val,n),-1===s?n.ret=-1:s>0&&(t.flags.MatchZeroOrMore||t.flags.MatchOneOrMore||"unlimited"===t.flags.MatchMaximum?n.ret=-1:t.flags.MatchMaximum?n.ret=parseInt(t.flags.MatchMaximum,10)*s:n.ret=s),null):t.val},ee=function(e,t,n){var r=t.type;if(c===r){var a,l=[],u=0,s=t.val.length;for(u=0;s>u&&(a=t.val[u],l.push(a),v===a.type&&(a.flags.MatchZeroOrOne||a.flags.MatchZeroOrMore||"0"===a.flags.MatchMinimum)||M===a.type&&(a.flags.MatchStart||a.flags.MatchEnd));u++);return l.length?l:null}return t.val},te=function(e,t,n){if(null!=n.ret)return-1===n.ret?e=-1:e+=n.ret,e;if(-1===e)return e;if(M===t.type&&t.flags.MatchEnd)return n.stop=1,e;var r=t.type;return C===r||O===r||d===r||m===r||M===r&&!t.flags.MatchStart&&!t.flags.MatchEnd?e+=1:b===r&&(e+=t.val.length),e},ne=function(e,t,n){if(null!=n.ret)return e+=n.ret;if(M===t.type&&t.flags.MatchEnd)return n.stop=1,e;var r=t.type,a=null;if(C===r)a=t.val;else if(O===r)a=E(t.val);else if(d===r||m===r)a=[t.flags.Char];else if(M!==r||t.flags.MatchStart||t.flags.MatchEnd)b===r&&(a=t.val);else{var l=t.val;a="D"===l?[F(!1)]:"W"===l?[_(!1)]:"S"===l?[q(!1)]:"d"===l?[F()]:"w"===l?[_()]:"s"===l?[q()]:"."===l&&t.flags.MatchAnyChar?[H()]:["\\"+l]}return a&&(e+=b===r?n.isCaseInsensitive?J(a):a:P(n.isCaseInsensitive?J(a,!0):a,!n.node||!n.node.flags.NotMatch)),e},re=function(e,t,n){if(null!=n.ret)return e.positive=G(e.positive,n.ret.positive),e.negative=G(e.negative,n.ret.negative),e;if(M===t.type&&t.flags.MatchEnd)return n.stop=1,e;var r=t.type,a=n.node&&y===n.node.type,u=a&&n.node.flags.NotMatch,s=u?"negative":"positive";if(C===r)e[s]=G(e[s],t.val);else if(O===r)e[s]=G(e[s],E(t.val));else if(d===r||m===r)e[s][t.flags.Char]=1;else if(M!==r||t.flags.MatchStart||t.flags.MatchEnd)b===r&&(e.positive[t.val[l](0)]=1);else{var i=t.val;"D"===i?e[u?"positive":"negative"]["\\d"]=1:"W"===i?e[u?"positive":"negative"]["\\w"]=1:"S"===i?e[u?"positive":"negative"]["\\s"]=1:e[s]["\\"+i]=1}return e},ae=function(e){var t=!1;return e.length>2&&"x"===e[l](0)&&W(j,e,1,2,2)?[t=e.slice(0,3),t.slice(1)]:!1},le=function(e){var t=!1;return e.length>4&&"u"===e[l](0)&&W(j,e,1,4,4)?[t=e.slice(0,5),t.slice(1)]:!1},ue=function(e){var t,n=e.length,r=0,a=!1,u=!1;return n>2&&"{"===e[l](r)?(a=["","",null],r++,(t=B(k,e,r))&&(r+=t),(t=D(Z,e,r))?(a[1]=e.slice(r,r+t),r+=t,(t=B(k,e,r))&&(r+=t),n>r&&","===e[l](r)&&(r+=1,u=!0),(t=B(k,e,r))&&(r+=t),(t=D(Z,e,r))&&(a[2]=e.slice(r,r+t),r+=t),(t=B(k,e,r))&&(r+=t),n>r&&"}"===e[l](r)?(r++,a[0]=e.slice(0,r),u||(a[2]=a[1]),a):!1):!1):!1},se=function(e){var t,n,r,u,s,f,c,h=[],g=[],v={},d=!1,m=!1;for("^"===e.re[l](e.pos)&&(v.NotMatch=1,e.pos++),r=e.len;e.pos<r;)if(c=!1,u=n,n=e.re[l](e.pos++),m=o==n,m&&(n=e.re[l](e.pos++)),m&&("u"===n?(f=le(e.re.substr(e.pos-1)),e.pos+=f[0].length-1,n=a(parseInt(f[1],16)),c=!0):"x"===n&&(f=ae(e.re.substr(e.pos-1)),e.pos+=f[0].length-1,n=a(parseInt(f[1],16)),c=!0)),d)g.length&&(h.push(x(C,g)),g=[]),s[1]=n,d=!1,h.push(x(O,s));else if(m)!c&&p[i](n)&&"/"!=n?(g.length&&(h.push(x(C,g)),g=[]),t={},t[p[n]]=1,h.push(x(M,n,t))):g.push(n);else{if("]"===n)return g.length&&(h.push(x(C,g)),g=[]),x(y,h,v);"-"===n?(s=[u,""],g.pop(),d=!0):g.push(n)}return g.length&&(h.push(x(C,g)),g=[]),x(y,h,v)},ie=function he(e){var t,n,r,u,s,y="",C=0,O=[],S=[],N={},I=!1;for(e.inGroup>0&&(s=e.re.substr(e.pos,2),"?:"===s?(N.NotCaptured=1,e.pos+=2):"?="===s?(N.LookAhead=1,e.pos+=2):"?!"===s&&(N.NegativeLookAhead=1,e.pos+=2),N.GroupIndex=++e.groupIndex),t=e.len;e.pos<t;)if(n=e.re[l](e.pos++),I=o==n,I&&(n=e.re[l](e.pos++)),I)"u"===n?(C&&(S.push(x(b,y)),y="",C=0),r=le(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,S.push(x(d,r[0],{Char:a(parseInt(r[1],16)),Code:r[1]}))):"x"===n?(C&&(S.push(x(b,y)),y="",C=0),r=ae(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,S.push(x(m,r[0],{Char:a(parseInt(r[1],16)),Code:r[1]}))):p[i](n)&&"/"!=n?(C&&(S.push(x(b,y)),y="",C=0),u={},u[p[n]]=1,S.push(x(M,n,u))):(y+=n,C+=1);else{if(e.inGroup>0&&")"===n)return C&&(S.push(x(b,y)),y="",C=0),O.length?(O.push(x(c,S)),S=[],u={},u[f["|"]]=1,x(g,x(h,O,u),N)):x(g,x(c,S),N);if("|"===n)C&&(S.push(x(b,y)),y="",C=0),O.push(x(c,S)),S=[];else if("["===n)C&&(S.push(x(b,y)),y="",C=0),S.push(se(e));else if("("===n)C&&(S.push(x(b,y)),y="",C=0),e.inGroup+=1,S.push(he(e)),e.inGroup-=1;else if("{"===n){C&&(S.push(x(b,y)),y="",C=0),r=ue(e.re.substr(e.pos-1)),e.pos+=r[0].length-1,u={val:r[0],MatchMinimum:r[1],MatchMaximum:r[2]||"unlimited"},u[f[n]]=1,e.pos<t&&"?"==e.re[l](e.pos)?(u.isGreedy=0,e.pos++):u.isGreedy=1;var A=S.pop();b===A.type&&A.val.length>1&&(S.push(x(b,A.val.slice(0,-1))),A.val=A.val.slice(-1)),S.push(x(v,A,u))}else if("*"===n||"+"===n||"?"===n){C&&(S.push(x(b,y)),y="",C=0),u={},u[f[n]]=1,e.pos<t&&"?"==e.re[l](e.pos)?(u.isGreedy=0,e.pos++):u.isGreedy=1;var A=S.pop();b===A.type&&A.val.length>1&&(S.push(x(b,A.val.slice(0,-1))),A.val=A.val.slice(-1)),S.push(x(v,A,u))}else f[i](n)?(C&&(S.push(x(b,y)),y="",C=0),u={},u[f[n]]=1,S.push(x(M,n,u))):(y+=n,C+=1)}return C&&(S.push(x(b,y)),y="",C=0),O.length?(O.push(x(c,S)),S=[],u={},N[f["|"]]=1,x(h,O,u)):x(c,S)},oe=function ge(e,t){return this instanceof ge?void(e&&this.set(e,t)):new ge(e,t)};return oe.VERSION=t,oe.Node=x,oe.getCharRange=E,oe[n]={constructor:oe,ast:null,re:null,fl:null,dispose:function(){var e=this;return e.ast=null,e.re=null,e.fl=null,e},set:function(e,t){var n=this;if(e){t=t||"/",e=e.toString();for(var r,a=e.length,u={};a>0&&(r=e[l](a-1),t!==r);)u[r]=1,a--;e=a>0?t===e[l](0)&&t===e[l](a-1)?e.slice(1,a-1):e.slice(0,a):"",n.re!==e&&(n.ast=null),n.re=e,n.fl=u}return n},analyze:function(){var e=this;return null!=e.re&&null===e.ast&&(e.ast=ie(new S(e.re))),e},compile:function(e){var t=this;return null==t.re?null:(e=e||t.fl||{},new RegExp(t.re,(e.g||e.G?"g":"")+(e.i||e.I?"i":"")+(e.m||e.M?"m":"")))},tree:function(e){var t=this;return null==t.re?null:(null===t.ast&&t.analyze(),!0===e?t.ast.toObject():t.ast)},sample:function(e,t){var n,r=this;if(null==r.re)return null;if(null===r.ast&&r.analyze(),n={map:X,reduce:ne,maxLength:0|e||1,isCaseInsensitive:null!=r.fl.i},t=0|t||1,t>1){for(var a=new Array(t),l=0;t>l;l++)a[l]=Q("",r.ast,n);return a}return Q("",r.ast,n)},minimum:function(){var e,t=this;return null==t.re?0:(null===t.ast&&t.analyze(),e={map:Y,reduce:te},0|Q(0,t.ast,e))},maximum:function(){var e,t=this;return null==t.re?0:(null===t.ast&&t.analyze(),e={map:K,reduce:te},Q(0,t.ast,e))},peek:function(){var e,t,n,r,a,u,s,i=this;if(null==i.re)return null;null===i.ast&&i.analyze(),e={map:ee,reduce:re},n=Q({positive:{},negative:{}},i.ast,e),t=null!=i.fl.i;for(r in n){s={},u=n[r];for(a in u)"\\d"===a?(delete u[a],s=G(s,E("0","9"))):"\\s"===a?(delete u[a],s=G(s,["\f","\n","\r","	","\x0B","Â ","\u2028","\u2029"])):"\\w"===a?(delete u[a],s=G(s,["_"].concat(E("0","9")).concat(E("a","z")).concat(E("A","Z")))):"\\."===a?(delete u[a],s[f["."]]=1):"\\"!==a[l](0)&&t?(s[a.toLowerCase()]=1,s[a.toUpperCase()]=1):"\\"===a[l](0)&&delete u[a];n[r]=G(u,s)}return n}},oe});